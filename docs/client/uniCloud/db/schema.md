# 8、关于schema的说明

**先说结论：vk框架不依赖 `schema`，`schema` 对vk框架不生效。（如果你用JQL去操作数据库，`schema` 是生效的）**

如果你想知道原因，那么继续往下看。

云开发的数据库为 `mogondb`，它与我们之前用的 `mysql` 不同，`mogondb` 其实没有所谓的字段这个概念。

即在 `mogondb` 中，没有所谓的 `schema（表结构）`，`schema` 是 `uniCloud` 官方为了配合 `clientDB（前端操作数据库）` 而生，它的主要作用是：

1. 因为前端操作数据库不安全，因此需要schema来控制读写权限。（这也是schema诞生的原因，前端操作数据库必须要有这个schema来控制权限）
2. 描述现有的数据含义。可以一目了然的阅读每个表、每个字段的用途。
3. 对每个字段进行一些规则约束，如必填，若默认值等等。
4. 直接映射表的连表关系，通过JQL可以很方便的进行连表。
5. 根据schema自动生成前端界面（schema2code），包括列表、详情、新建和编辑页面，自动处理校验规则。

因此 `schema` 就是官方为了前端操作数据库的安全性和便捷性而设计的。（后面又出了JQL，JQL也对 `schema` 生效，同时JQL可以写在云函数端）

`schema` 其实很强大，但 `schema` 也有一些弊端，如下：

1. 权限设计是以数据库字段为设计维度，那么所有表字段加起来有多少？而你的系统的接口的数量有多少？通常接口的数量小于数据库表名和字段的数量，故以字段为维度做权限的工作量会更大。
2. 因为前端操作数据库并不能解决你系统所有功能，部分功能依然要用云函数或云对象开发如 `uni-id-co`，所以除了学会`clientDB`，你依然要学会云函数或云对象。
3. 由于前端操作数据库可以自由拼写where，因此可能会造成类似 `where="1=1 or (xxx)"` 来进行类似SQL注入攻击，同时还可以 `where="token > abc"` 来暴力破解用户的token。（可能还有其他你没想到的攻击方案）
4. 一旦你的表权限设计有漏洞，攻击者就能看到你这个表所有数据，甚至可以把你表的数据全部修改或全部删除。（当然这个前提是你自己把表的权限设计错了）

但总体来说，`schema` 还是相对安全的。（没有绝对的安全）

在 `mogondb` 中，表的数据=list，行记录=json，字段=json的属性。

因此字段可以任意拓展，你通过update一个不存在的字段，就等于添加这个字段并设置这个字段的值。（这也是mogondb的优势）

同时 `mogondb` 允许1个表内所有的行记录内的字段可以不统一，即第一条记录有a字段，第二条记录可以没有a字段。

